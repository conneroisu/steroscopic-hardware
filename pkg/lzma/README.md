# lzma

Package lzma package implements reading and writing of LZMA format compressed data.

<!-- gomarkdoc:embed:start -->

<!-- Code generated by gomarkdoc. DO NOT EDIT -->

# lzma

```go
import "github.com/conneroisu/steroscopic-hardware/pkg/lzma"
```

Package lzma package implements reading and writing of LZMA format compressed data.

Reference implementation is LZMA SDK version 4.65 originally developed by Igor Pavlov, available online at:

```
http://www.7-zip.org/sdk.html
```

Usage examples. Write compressed data to a buffer:

```
var b bytes.Buffer
w := lzma.NewWriter(&b)
w.Write([]byte("hello, world\n"))
w.Close()
```

read that data back:

```
r := lzma.NewReader(&b)
io.Copy(os.Stdout, r)
r.Close()
```

If the data is bigger than you'd like to hold into memory, use pipes. Write compressed data to an io.PipeWriter:

```
pr, pw := io.Pipe()
 go func() {
 	defer pw.Close()
	w := lzma.NewWriter(pw)
	defer w.Close()
	// the bytes.Buffer would be an io.Reader used to read uncompressed data from
	io.Copy(w, bytes.NewBuffer([]byte("hello, world\n")))
 }()
```

and read it back:

```
defer pr.Close()
r := lzma.NewReader(pr)
defer r.Close()
// the os.Stdout would be an io.Writer used to write uncompressed data to
io.Copy(os.Stdout, r)
```

### LZMA compressed file format

\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-
| Offset | Size | Description |
|\-\-\-\-\-\-\-\-|\-\-\-\-\-\-|\-\-\-\-\-\-\-\-\-\-\-\-\-|
| 0 | 1 | Special LZMA properties \(lc,lp, pb in encoded form\) |
| 1 | 4 | Dictionary size \(little endian\) |
| 5 | 8 | Uncompressed size \(little endian\). Size \-1 stands for unknown size |

## Index

- [Constants](<#constants>)
- [func NewReader\(r io.Reader\) io.ReadCloser](<#NewReader>)
- [func NewWriter\(w io.Writer\) \(io.WriteCloser, error\)](<#NewWriter>)
- [func NewWriterLevel\(w io.Writer, level int\) \(io.WriteCloser, error\)](<#NewWriterLevel>)
- [func NewWriterSize\(w io.Writer, size int64\) \(io.WriteCloser, error\)](<#NewWriterSize>)
- [func NewWriterSizeLevel\(w io.Writer, size int64, level int\) \(io.WriteCloser, error\)](<#NewWriterSizeLevel>)
- [type ArgumentValueError](<#ArgumentValueError>)
  - [func \(e \*ArgumentValueError\) Error\(\) string](<#ArgumentValueError.Error>)
- [type HeaderError](<#HeaderError>)
  - [func \(e HeaderError\) Error\(\) string](<#HeaderError.Error>)
- [type NWriteError](<#NWriteError>)
  - [func \(e \*NWriteError\) Error\(\) string](<#NWriteError.Error>)
- [type Reader](<#Reader>)
- [type StreamError](<#StreamError>)
  - [func \(e \*StreamError\) Error\(\) string](<#StreamError.Error>)
- [type Writer](<#Writer>)


## Constants

<a name="BestSpeed"></a>

```go
const (
    // BestSpeed is the fastest compression level.
    BestSpeed = 1
    // BestCompression is the compression level that gives the best compression ratio.
    BestCompression = 9
    // DefaultCompression is the default compression level.
    DefaultCompression = 5
)
```

<a name="NewReader"></a>
## func [NewReader](<https://github.com/conneroisu/steroscopic-hardware/blob/main/pkg/lzma/decoder.go#L47>)

```go
func NewReader(r io.Reader) io.ReadCloser
```

NewReader returns a new [io.ReadCloser](<https://pkg.go.dev/io/#ReadCloser>) that can be used to read the uncompressed version of \`r\`

It is the caller's responsibility to call Close on the [io.ReadCloser](<https://pkg.go.dev/io/#ReadCloser>) when finished reading.

<a name="NewWriter"></a>
## func [NewWriter](<https://github.com/conneroisu/steroscopic-hardware/blob/main/pkg/lzma/encoder.go#L88>)

```go
func NewWriter(w io.Writer) (io.WriteCloser, error)
```

NewWriter creates a new Writer that compresses data to the given Writer using the default compression level.

Same as NewWriterSizeLevel\(w, \-1, DefaultCompression\).

<a name="NewWriterLevel"></a>
## func [NewWriterLevel](<https://github.com/conneroisu/steroscopic-hardware/blob/main/pkg/lzma/encoder.go#L60>)

```go
func NewWriterLevel(w io.Writer, level int) (io.WriteCloser, error)
```

NewWriterLevel creates a new Writer that compresses data to the given Writer using the given level.

Level is any integer value between [lzma.BestSpeed](<#BestSpeed>) and [lzma.BestCompression](<#BestSpeed>).

Same as lzma.NewWriterSizeLevel\(w, \-1, level\).

<a name="NewWriterSize"></a>
## func [NewWriterSize](<https://github.com/conneroisu/steroscopic-hardware/blob/main/pkg/lzma/encoder.go#L80>)

```go
func NewWriterSize(w io.Writer, size int64) (io.WriteCloser, error)
```

NewWriterSize creates a new Writer that compresses data to the given Writer using the given size as the uncompressed data size.

If size is unknown, use \-1 instead.

Level is any integer value between [lzma.BestSpeed](<#BestSpeed>) and [lzma.BestCompression](<#BestSpeed>).

Parameter size and the size, [lzma.DefaultCompression](<#BestSpeed>), \(the lzma header\) are written to the passed in writer before any compressed data.

If size is \-1, last bytes are encoded in a different way to mark the end of the stream. The size of the compressed data will increase by 5 or 6 bytes.

Same as NewWriterSizeLevel\(w, size, lzma.DefaultCompression\).

<a name="NewWriterSizeLevel"></a>
## func [NewWriterSizeLevel](<https://github.com/conneroisu/steroscopic-hardware/blob/main/pkg/lzma/encoder.go#L40>)

```go
func NewWriterSizeLevel(w io.Writer, size int64, level int) (io.WriteCloser, error)
```

NewWriterSizeLevel writes to the given Writer the compressed version of data written to the returned [io.WriteCloser](<https://pkg.go.dev/io/#WriteCloser>). It is the caller's responsibility to call Close on the [io.WriteCloser](<https://pkg.go.dev/io/#WriteCloser>) when done.

Parameter size is the actual size of uncompressed data that's going to be written to [io.WriteCloser](<https://pkg.go.dev/io/#WriteCloser>). If size is unknown, use \-1 instead.

Parameter level is any integer value between [lzma.BestSpeed](<#BestSpeed>) and [lzma.BestCompression](<#BestSpeed>).

Arguments size and level \(the lzma header\) are written to the writer before any compressed data.

If size is \-1, last bytes are encoded in a different way to mark the end of the stream. The size of the compressed data will increase by 5 or 6 bytes.

The reason for which size is an argument is that, unlike gzip which appends the size and the checksum at the end of the stream, lzma stores the size before any compressed data. Thus, lzma can compute the size while reading data from pipe.

<a name="ArgumentValueError"></a>
## type [ArgumentValueError](<https://github.com/conneroisu/steroscopic-hardware/blob/main/pkg/lzma/errors.go#L39-L42>)

An ArgumentValueError reports an error encountered while parsing user provided arguments.

```go
type ArgumentValueError struct {
    // contains filtered or unexported fields
}
```

<a name="ArgumentValueError.Error"></a>
### func \(\*ArgumentValueError\) [Error](<https://github.com/conneroisu/steroscopic-hardware/blob/main/pkg/lzma/errors.go#L46>)

```go
func (e *ArgumentValueError) Error() string
```

Error returns the error message and implements the error interface on the ArgumentValueError type.

<a name="HeaderError"></a>
## type [HeaderError](<https://github.com/conneroisu/steroscopic-hardware/blob/main/pkg/lzma/errors.go#L6-L8>)

HeaderError is returned when the header is corrupt.

```go
type HeaderError struct {
    // contains filtered or unexported fields
}
```

<a name="HeaderError.Error"></a>
### func \(HeaderError\) [Error](<https://github.com/conneroisu/steroscopic-hardware/blob/main/pkg/lzma/errors.go#L12>)

```go
func (e HeaderError) Error() string
```

Error returns the error message and implements the error interface on the HeaderError type.

<a name="NWriteError"></a>
## type [NWriteError](<https://github.com/conneroisu/steroscopic-hardware/blob/main/pkg/lzma/errors.go#L28-L30>)

NWriteError is returned when the number of bytes returned by Writer.Write\(\) didn't meet expectances.

```go
type NWriteError struct {
    // contains filtered or unexported fields
}
```

<a name="NWriteError.Error"></a>
### func \(\*NWriteError\) [Error](<https://github.com/conneroisu/steroscopic-hardware/blob/main/pkg/lzma/errors.go#L34>)

```go
func (e *NWriteError) Error() string
```

Error returns the error message and implements the error interface on the NWriteError type.

<a name="Reader"></a>
## type [Reader](<https://github.com/conneroisu/steroscopic-hardware/blob/main/pkg/lzma/range.go#L25-L28>)

Reader is the actual read interface needed by \[NewDecoder\].

If the passed in io.Reader does not also have ReadByte, the \[NewDecoder\] will introduce its own buffering.

```go
type Reader interface {
    io.Reader
    ReadByte() (c byte, err error)
}
```

<a name="StreamError"></a>
## type [StreamError](<https://github.com/conneroisu/steroscopic-hardware/blob/main/pkg/lzma/errors.go#L17-L19>)

StreamError is returned when the stream is corrupt.

```go
type StreamError struct {
    // contains filtered or unexported fields
}
```

<a name="StreamError.Error"></a>
### func \(\*StreamError\) [Error](<https://github.com/conneroisu/steroscopic-hardware/blob/main/pkg/lzma/errors.go#L23>)

```go
func (e *StreamError) Error() string
```

Error returns the error message and implements the error interface on the StreamError type.

<a name="Writer"></a>
## type [Writer](<https://github.com/conneroisu/steroscopic-hardware/blob/main/pkg/lzma/range.go#L134-L138>)

Writer is the actual write interface needed by \[NewEncoder\].

If the passed in [io.Writer](<https://pkg.go.dev/io/#Writer>) does not also have WriteByte and Flush, the \[NewEncoder\] function will wrap it into a bufio.Writer.

```go
type Writer interface {
    io.Writer
    Flush() error
    WriteByte(c byte) error
}
```

Generated by [gomarkdoc](<https://github.com/princjef/gomarkdoc>)


<!-- gomarkdoc:embed:end -->
